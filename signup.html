<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Create Account - FunaGig</title>
    <link rel="stylesheet" href="styles.css" />
</head>

<body>
    <header class="navbar">
        <div class="brand">
            <div class="logo"></div> FunaGig
        </div>
        <nav class="nav-actions">
            <a class="btn ghost" href="index.html">Home</a>
            <a class="btn" href="auth.html">Log In</a>
        </nav>
    </header>

    <main class="container" style="max-width:1100px;">
        <div class="grid-2" style="align-items: center;">
            <form class="card" id="signup-form">
                <h1 class="h1" style="font-size:32px; text-align:center;">Create Your Account</h1>
                <p class="subtle mb-10" style="text-align:center;">Join FunaGig as a Student or Business</p>
                
                <div class="field">
                    <label class="label">I am a *</label>
                    <select class="select" id="role" name="role" required>
                        <option value="">Select your role</option>
                        <option value="student">Student</option>
                        <option value="business">Business</option>
                    </select>
                    <div class="error-message" id="roleError"></div>
                </div>
                
                <div class="field">
                    <label class="label">Full Name (or Company Name) *</label>
                    <input class="input" id="name" name="name" placeholder="e.g. Amanya Peter or Your Company Inc." required />
                    <div class="error-message" id="nameError"></div>
                </div>
                
                <div class="field">
                    <label class="label">Email Address *</label>
                    <input type="email" class="input" id="email" name="email" placeholder="you@example.com" required />
                    <div class="error-message" id="emailError"></div>
                </div>
                
                <div class="field">
                    <label class="label">Password *</label>
                    <input type="password" class="input" id="password" name="password" placeholder="••••••••" required />
                    <div class="error-message" id="passwordError"></div>
                </div>
                
                <div class="field">
                    <label class="label">Confirm Password *</label>
                    <input type="password" class="input" id="confirmPassword" name="confirmPassword" placeholder="••••••••" required />
                    <div class="error-message" id="confirmPasswordError"></div>
                </div>
                
                <!-- Student-specific fields (hidden by default) -->
                <div id="student-fields" style="display: none;">
                    <div class="row">
                        <div class="field">
                            <label class="label">University *</label>
                            <input class="input" id="university" name="university" placeholder="e.g. Makerere University" />
                            <div class="error-message" id="universityError"></div>
                        </div>
                        <div class="field">
                            <label class="label">Major/Field of Study *</label>
                            <input class="input" id="major" name="major" placeholder="e.g. Computer Science" />
                            <div class="error-message" id="majorError"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Business-specific fields (hidden by default) -->
                <div id="business-fields" style="display: none;">
                    <div class="field">
                        <label class="label">Industry *</label>
                        <select class="select" id="industry" name="industry">
                            <option value="">Select your industry</option>
                            <option value="technology">Technology</option>
                            <option value="retail">Retail</option>
                            <option value="finance">Finance</option>
                            <option value="healthcare">Healthcare</option>
                            <option value="education">Education</option>
                            <option value="manufacturing">Manufacturing</option>
                            <option value="consulting">Consulting</option>
                            <option value="marketing">Marketing</option>
                            <option value="other">Other</option>
                        </select>
                        <div class="error-message" id="industryError"></div>
                    </div>
                </div>
                
                <div class="field">
                    <label class="label">
                        <input type="checkbox" id="terms" name="terms" required /> 
                        I agree to the <a href="#" style="color: var(--primary);">Terms of Service</a> *
                    </label>
                    <div class="error-message" id="termsError"></div>
                </div>
                
                <div class="field">
                    <label class="label">
                        <input type="checkbox" id="privacy" name="privacy" required /> 
                        I accept the <a href="#" style="color: var(--primary);">Privacy Policy</a> *
                    </label>
                    <div class="error-message" id="privacyError"></div>
                </div>
                
                <button type="submit" class="btn" style="width: 100%;">Create Account</button>
                
                <div class="section mt-20" style="text-align:center;">
                    <p class="subtle">Already have an account? <a href="auth.html" style="color: var(--primary);">Sign in here</a></p>
                </div>
            </form>
            
            <div class="section" style="min-height:520px; display:grid; place-content:center; text-align:center; background:#e6f2ff;">
                <h3>Join in Seconds</h3>
                <p class="subtle">One simple form to connect students and businesses.</p>
                <div style="margin-top: 20px;">
                    <div class="section" style="background: white; margin: 10px 0;">
                        <h4>✓ Students</h4>
                        <p class="subtle">Find gigs that match your skills</p>
                    </div>
                    <div class="section" style="background: white; margin: 10px 0;">
                        <h4>✓ Businesses</h4>
                        <p class="subtle">Post jobs and hire talent fast</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Show/hide role-specific fields
        document.getElementById('role').addEventListener('change', function() {
            const studentFields = document.getElementById('student-fields');
            const businessFields = document.getElementById('business-fields');
            studentFields.style.display = this.value === 'student' ? 'block' : 'none';
            businessFields.style.display = this.value === 'business' ? 'block' : 'none';
        });

        document.getElementById('signup-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            clearErrors();
            
            const formData = {
                role: document.getElementById('role').value,
                name: document.getElementById('name').value.trim(),
                email: document.getElementById('email').value.trim(),
                password: document.getElementById('password').value,
                confirmPassword: document.getElementById('confirmPassword').value,
                university: document.getElementById('university').value.trim(),
                major: document.getElementById('major').value.trim(),
                industry: document.getElementById('industry').value,
                terms: document.getElementById('terms').checked,
                privacy: document.getElementById('privacy').checked
            };
            
            let isValid = true;
            
            if (!formData.role) {
                showError('roleError', 'Please select your role');
                isValid = false;
            }
            
            if (!formData.name) {
                showError('nameError', 'Name is required');
                isValid = false;
            }
            
            if (!formData.email) {
                showError('emailError', 'Email is required');
                isValid = false;
            } else if (!isValidEmail(formData.email)) {
                showError('emailError', 'Please enter a valid email address');
                isValid = false;
            }
            
            if (!formData.password) {
                showError('passwordError', 'Password is required');
                isValid = false;
            } else if (formData.password.length < 6) {
                showError('passwordError', 'Password must be at least 6 characters');
                isValid = false;
            }
            
            if (formData.password !== formData.confirmPassword) {
                showError('confirmPasswordError', 'Passwords do not match');
                isValid = false;
            }
            
            if (formData.role === 'student') {
                if (!formData.university) {
                    showError('universityError', 'University is required');
                    isValid = false;
                }
                if (!formData.major) {
                    showError('majorError', 'Major is required');
                    isValid = false;
                }
            } else if (formData.role === 'business') {
                if (!formData.industry) {
                    showError('industryError', 'Industry is required');
                    isValid = false;
                }
            }
            
            if (!formData.terms) {
                showError('termsError', 'You must agree to the Terms of Service');
                isValid = false;
            }
            
            if (!formData.privacy) {
                showError('privacyError', 'You must accept the Privacy Policy');
                isValid = false;
            }
            
            if (isValid) {
                // Send to backend
                apiFetch('/signup', {
                    method: 'POST',
                    body: JSON.stringify(formData)
                })
                .then(response => {
                    if (response.success) {
                        alert('Account created successfully! Please log in.');
                        window.location.href = 'auth.html';
                    } else {
                        showError('emailError', response.error || 'Signup failed');
                    }
                })
                .catch(error => {
                    showError('emailError', 'Error: Could not connect to server');
                    console.error('Signup error:', error);
                });
            }
        });
        
        function clearErrors() {
            const errorElements = document.querySelectorAll('.error-message');
            errorElements.forEach(element => {
                element.textContent = '';
                element.style.display = 'none';
            });
        }
        
        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            errorElement.textContent = message;
            errorElement.style.display = 'block';
            errorElement.style.color = 'var(--danger)';
            errorElement.style.fontSize = '12px';
            errorElement.style.marginTop = '4px';
        }
        
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
    </script>
    <script src="app.js"></script>
</body>
</html>
